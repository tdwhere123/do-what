# do-what 核心逻辑与模块

## 核心功能区块

## 1. session

- 负责用户任务输入、消息回流、会话状态切换。
- 是业务主链路第一入口。

## 2. proto

- 定义 app / desktop / orchestrator / server 间的通信形态。
- 保证事件、命令、状态在多 runtime 下可统一处理。

## 3. scheduled

- 管理延迟执行/定时任务。
- 与工作区配置与服务层协同。

## 4. soul

- 管理长期上下文与记忆资产。
- 服务于多轮任务一致性。

## 5. skills

- 管理本地技能集合与安装流程。
- 支撑可扩展自动化能力。

## 6. extensions

- 管理扩展能力（MCP、第三方集成等）。
- `opencode-router` 属于此类可选扩展，不是默认主链路。

## 业务与桌面链路关系

- 默认开发以业务链路为主：`pnpm dev`。
- 桌面链路用于系统集成验证：`pnpm run dev:desktop`。
- 二者共享核心功能区块语义，但依赖层级不同。
