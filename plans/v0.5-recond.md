# v0.5 执行记录（实际）

## 本轮完成内容（对应 v0.5-spec）

### 1) 新增 Design Tokens
- 新增 `packages/app/src/app/styles/tokens.css`，定义暖米色体系、边框、文本、状态色、runtime badge、间距、圆角、字体、阴影 token。

### 2) 全局样式接入与兼容映射
- 修改 `packages/app/src/app/index.css`：
  - 顶部引入 `@import "./styles/tokens.css"`
  - 将 `--dls-*` 主变量映射到新 token
  - 新增 `--dls-background-*` 兼容映射
  - `body` 改为暖米色背景与 token 字体
  - 新增 `.runtime-badge` / `--cc|--cx|--oc` 样式

### 3) Session DAG 组件
- 新增 `packages/app/src/app/components/session-dag.tsx`：
  - 折叠态显示 `◆ N sessions`
  - 展开态显示 `Session Flow` 列表
  - 数据源基于 `projects + agentRuns`，按 `startedAt` 排序
  - 支持按 `parentSessionIds.length` 缩进表示依赖层级（v0.5 简化版）
  - 点击条目触发 `onSelectSession`

### 4) Session 页面接入 DAG
- 修改 `packages/app/src/app/pages/session.tsx`：
  - 引入并渲染 `SessionDagWidget`
  - 增加 `activeProjectId` 计算（根据当前 session 反查 project）
  - 主内容区改为 `relative` 以承载右上角浮层组件

### 5) Sidebar 暖色背景接入
- 修改 `packages/app/src/app/components/session/sidebar.tsx` 根容器：
  - 使用 `bg-[var(--color-bg-sidebar)]`
  - 使用 `border-[var(--color-border-subtle)]`

## 验证
- 已执行：`pnpm typecheck`
- 已执行：`pnpm dev:ui`（启动并截图主页面）

## 备注
- `.opencode/skills/solidjs-patterns/SKILL.md` 在当前仓库不存在，按现有 SolidJS 代码风格完成实现。
- DAG 当前对 OpenCode 原生 session 使用项目 `sessionIds` 占位显示（无 run 元数据时以 id 展示），后续可在 store 暴露标题后进一步补齐。
