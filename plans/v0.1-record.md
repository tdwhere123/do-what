# v0.1 执行记录（实际）

## 本轮按 v0.1-spec 完成项

### 自动更新模块
- 已删除 `packages/app/src/app/context/updater.ts`。
- 已从 `packages/app/package.json` 删除 `@tauri-apps/plugin-updater`。
- 已从 `packages/desktop/src-tauri/tauri.conf.json` 删除 updater plugin 配置。
- 已从 `packages/desktop/src-tauri/Cargo.toml` 删除 `tauri-plugin-updater` 依赖。
- 已从 `packages/desktop/src-tauri/src/lib.rs` 移除 `tauri_plugin_updater` 注册与 `updater_environment` 命令挂载。
- 已删除 `packages/desktop/src-tauri/src/updater.rs` 与 `packages/desktop/src-tauri/src/commands/updater.rs`，并清理 `commands/mod.rs` 中的 updater 模块声明。
- `app.tsx` 中保留了更新状态透传，但删除了旧 tab 结构下的依赖路径，并调整为当前状态可编译。

### OpenCode Router 模块
- 已删除 `packages/opencode-router/` 整个包。
- 已删除 `packages/app/src/app/pages/identities.tsx`。
- 已从 `pnpm-workspace.yaml` 显式排除 `packages/opencode-router`。
- 已从 `packages/desktop/src-tauri/tauri.conf.json` 删除 `sidecars/opencode-router`。

### Dashboard Tab 合并
- 已将 Dashboard 主 tab 收敛为：
  - `scheduled`
  - `soul`
  - `skills`
  - `extensions`
  - `settings`
- 清理了 `packages/app/src/app/system-state.ts` 中所有 updater 相关状态与函数：
  - `updateAutoCheck` / `updateAutoDownload`
  - `updateStatus` / `pendingUpdate` / `updateEnv`
  - `checkForUpdates` / `downloadUpdate` / `installUpdateAndRestart`
- 清理了 `packages/app/src/app/app.tsx` 中 updater 相关 import、effect、localStorage 读写与 props 透传。
- 清理了 `packages/app/src/app/pages/dashboard.tsx` 与 `packages/app/src/app/pages/session.tsx` 的更新胶囊 UI 与对应 props 依赖。
- 移除了 `packages/app/src/app/lib/tauri.ts` 中 `updaterEnvironment`。

### 2) OpenCode Router 模块下线（v0.1-spec 范围）
- 清理了 `packages/app/src/app/lib/openwork-server.ts`：
  - `OpenworkServerCapabilities.proxy` 改为仅保留 `opencode`。
  - 删除 `OpenworkOpenCodeRouter*` 类型与 client 中所有 OpenCode Router 方法。
- 清理了 `packages/app/src/app/lib/tauri.ts`：
  - 删除 `OpenCodeRouterInfo` 类型。
  - 删除 `opencodeRouterInfo` 函数。
- 清理了 `packages/app/src/app/context/openwork-server.ts` 中 Router 轮询状态与 effect。
- 桌面端删除：
  - `packages/desktop/src-tauri/src/commands/opencode_router.rs`
  - `packages/desktop/src-tauri/src/opencode_router/` 目录
  - 并同步清理 `commands/mod.rs` 与 `lib.rs` 的模块声明、命令注册、manager 挂载与退出清理逻辑。
- `packages/desktop/src-tauri/src/commands/engine.rs` 去掉对 OpenCode Router 启停与 health port 解析的依赖。

### 3) Dashboard 合并：新增 sessions tab
- `packages/app/src/app/pages/dashboard.tsx`：
  - 新增 `sessions` tab（桌面侧栏 + 移动底部导航）。
  - 新增 `Match when={props.tab === "sessions"}` 占位面板：`Sessions will appear here.`
  - 移动端底部导航改为 6 项（`grid-cols-6`）。
- `packages/app/src/app/app.tsx`：
  - 默认 dashboard tab 调整为 `sessions`。
  - dashboard tab 解析集合加入 `sessions`。

### 4) 记录与计划
- `plans/overview.md`：v0.1 状态保持“进行中”。
- 本文件（`plans/v0.1-record.md`）更新为按 spec 的本轮落地记录。

## 验证
- `pnpm --filter @different-ai/openwork-ui typecheck`：通过。
- `pnpm typecheck`：通过。
- `pnpm dev:ui`：Vite 可启动并 ready（本次用 `timeout`/手动中断结束进程）。

## 说明
- 依据 v0.1-spec 要求，本轮完成了 updater 与 opencode-router 在 app 主要路径和 desktop 命令层的清理。
- 截图尝试：已尝试使用 browser MCP 访问本地 `5173` 端口截图，但在该环境返回 `ERR_EMPTY_RESPONSE`，未能产出截图制品。
